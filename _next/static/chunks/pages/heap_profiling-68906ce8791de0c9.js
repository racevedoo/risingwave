(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{84808:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/heap_profiling",function(){return n(95404)}])},14993:function(e,t,n){"use strict";n.d(t,{OL:function(){return o},X8:function(){return c},xv:function(){return l}});var r=n(77617),a=n(79897);async function c(){let e=await a.Z.get("/api/metrics/cluster");return e}async function l(){let e=(await a.Z.get("/api/clusters/1")).map(r.cX.fromJSON);return e}async function o(){let e=(await a.Z.get("/api/clusters/2")).map(r.cX.fromJSON);return e}},6935:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(66479),a=n(67294);function c(e){let[t,n]=(0,a.useState)(),c=(0,r.pm)();return(0,a.useEffect)(()=>{let t=async()=>{try{let t=await e();n(t)}catch(e){c({title:"Error Occurred",description:e.toString(),status:"error",duration:5e3,isClosable:!0}),console.error(e)}};t()},[c,e]),{response:t}}},95404:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return S}});var r=n(85893),a=n(40639),c=n(83234),l=n(57026),o=n(47741),i=n(19604),s=n(45772),u=n.n(s),d=n(42474),f=n(9008),m=n.n(f),p=n(1864),h=n.n(p),g=n(67294),T=n(42571),v=n(96756),y=n(12240),j=n(79897),x=n(14993),w=n(6935);function S(){let{response:e}=(0,w.Z)(x.OL),[t,n]=(0,g.useState)(),[s,f]=(0,g.useState)(""),[p,S]=(0,g.useState)(),[b,O]=(0,g.useState)(),[A,k]=(0,g.useState)("Auto"),[N,C]=(0,g.useState)();async function _(e,t){if(e&&t&&e.length>0)try{let e=y.R_.fromJSON(await j.Z.get("/api/monitor/list_heap_profile/".concat(t)));S(e)}catch(e){console.error(e),f("Getting Profiling File List\n$Error: ".concat(e.message,"]"))}}async function E(){j.Z.get("/api/monitor/dump_heap_profile/".concat(t)),_(e,t)}async function P(){let e;if(void 0===b||void 0===N){console.log("selectedProfileList: ".concat(b,", analyzeTargetFileName: ").concat(N));return}let n=h().join(b.dir,N);f("Analyzing ".concat(N," from Compute Node ").concat(t));let r="Collapsed Profiling of Compute Node ".concat(t," for ").concat(N);try{let a=u()(n),c=await fetch("/api/monitor/analyze/".concat(t,"/").concat(a)).then(async e=>({filename:e.headers.get("content-disposition"),blob:await e.blob()})),l=window.URL.createObjectURL(c.blob),o=document.createElement("a");o.href=l,o.download=c.filename||(0,d.randomUUID)(),o.click(),e="".concat(r,"\n\nDownloaded!")}catch(t){e="".concat(r,"\n\nError: ").concat(t.message)}f(e)}(0,g.useEffect)(()=>{e&&!t&&e.length>0&&n(e[0].id)},[e,t]),(0,g.useEffect)(()=>{_(e,t)},[e,t]),(0,g.useEffect)(()=>{p&&("Auto"===A?O({dir:p.dir,name:p.nameAuto}):"Manually"===A?O({dir:p.dir,name:p.nameManually}):console.error("Bad profileType ".concat(A)))},[A,p]),(0,g.useEffect)(()=>{b&&b.name.length>0&&C(b.name[0])},[b]);let M=(0,r.jsxs)(a.kC,{p:3,height:"calc(50vh - 20px)",flexDirection:"column",children:[(0,r.jsx)(v.Z,{children:"Heap Profiling"}),(0,r.jsxs)(a.kC,{flexDirection:"row",height:"full",width:"full",children:[(0,r.jsxs)(a.gC,{mr:3,spacing:3,alignItems:"flex-start",width:200,height:"full",children:[(0,r.jsxs)(c.NI,{children:[(0,r.jsx)(c.lX,{textColor:"teal.500",children:"Dump Heap Profile"}),(0,r.jsxs)(a.gC,{children:[(0,r.jsx)(c.lX,{children:"Compute Nodes"}),(0,r.jsx)(l.Ph,{onChange:e=>n(parseInt(e.target.value)),children:e&&e.map(e=>{var t,n;return(0,r.jsxs)("option",{value:e.id,children:["(",e.id,") ",null===(t=e.host)||void 0===t?void 0:t.host,":",null===(n=e.host)||void 0===n?void 0:n.port]},e.id)})}),(0,r.jsx)(o.zx,{onClick:e=>E(),width:"full",children:"Dump"})]})]}),(0,r.jsxs)(c.NI,{children:[(0,r.jsx)(c.lX,{textColor:"teal.500",children:"Analyze Heap Profile"}),(0,r.jsxs)(a.gC,{children:[(0,r.jsx)(c.lX,{children:"Dumped By"}),(0,r.jsx)(l.Ph,{onChange:e=>k(e.target.value),children:["Auto","Manually"].map(e=>(0,r.jsx)("option",{value:e,children:e},e))}),(0,r.jsx)(c.lX,{children:"Dumped Files"}),(0,r.jsx)(l.Ph,{onChange:e=>C(e.target.value),children:b&&b.name.map(e=>(0,r.jsx)("option",{value:e,children:e},e))}),(0,r.jsx)(o.zx,{onClick:e=>P(),width:"full",children:"Analyze"})]})]})]}),(0,r.jsx)(a.xu,{flex:1,height:"full",ml:3,overflowX:"scroll",overflowY:"scroll",children:void 0===s?(0,r.jsx)(T.Z,{}):(0,r.jsx)(i.ZP,{language:"sql",options:{fontSize:13,readOnly:!0,renderWhitespace:"boundary",wordWrap:"on"},defaultValue:'Select a compute node and target profiling result file and click "Analyze"...',value:s})})]})]});return(0,r.jsxs)(g.Fragment,{children:[(0,r.jsx)(m(),{children:(0,r.jsx)("title",{children:"Heap Profiling"})}),M]})}},12240:function(e,t,n){"use strict";n.d(t,{Kv:function(){return r},R_:function(){return a}});let r={fromJSON:e=>({actorTraces:c(e.actorTraces)?Object.entries(e.actorTraces).reduce((e,t)=>{let[n,r]=t;return e[Number(n)]=String(r),e},{}):{},rpcTraces:c(e.rpcTraces)?Object.entries(e.rpcTraces).reduce((e,t)=>{let[n,r]=t;return e[n]=String(r),e},{}):{},compactionTaskTraces:c(e.compactionTaskTraces)?Object.entries(e.compactionTaskTraces).reduce((e,t)=>{let[n,r]=t;return e[n]=String(r),e},{}):{}}),toJSON(e){let t={};if(e.actorTraces){let n=Object.entries(e.actorTraces);n.length>0&&(t.actorTraces={},n.forEach(e=>{let[n,r]=e;t.actorTraces[n]=r}))}if(e.rpcTraces){let n=Object.entries(e.rpcTraces);n.length>0&&(t.rpcTraces={},n.forEach(e=>{let[n,r]=e;t.rpcTraces[n]=r}))}if(e.compactionTaskTraces){let n=Object.entries(e.compactionTaskTraces);n.length>0&&(t.compactionTaskTraces={},n.forEach(e=>{let[n,r]=e;t.compactionTaskTraces[n]=r}))}return t},create:e=>r.fromPartial(null!=e?e:{}),fromPartial(e){var t,n,r;let a={actorTraces:{},rpcTraces:{},compactionTaskTraces:{}};return a.actorTraces=Object.entries(null!==(t=e.actorTraces)&&void 0!==t?t:{}).reduce((e,t)=>{let[n,r]=t;return void 0!==r&&(e[Number(n)]=String(r)),e},{}),a.rpcTraces=Object.entries(null!==(n=e.rpcTraces)&&void 0!==n?n:{}).reduce((e,t)=>{let[n,r]=t;return void 0!==r&&(e[n]=String(r)),e},{}),a.compactionTaskTraces=Object.entries(null!==(r=e.compactionTaskTraces)&&void 0!==r?r:{}).reduce((e,t)=>{let[n,r]=t;return void 0!==r&&(e[n]=String(r)),e},{}),a}},a={fromJSON:e=>({dir:null!=e.dir?String(e.dir):"",nameManually:Array.isArray(null==e?void 0:e.nameManually)?e.nameManually.map(e=>String(e)):[],nameAuto:Array.isArray(null==e?void 0:e.nameAuto)?e.nameAuto.map(e=>String(e)):[]}),toJSON(e){var t,n;let r={};return""!==e.dir&&(r.dir=e.dir),(null===(t=e.nameManually)||void 0===t?void 0:t.length)&&(r.nameManually=e.nameManually),(null===(n=e.nameAuto)||void 0===n?void 0:n.length)&&(r.nameAuto=e.nameAuto),r},create:e=>a.fromPartial(null!=e?e:{}),fromPartial(e){var t,n,r;let a={dir:"",nameManually:[],nameAuto:[]};return a.dir=null!==(r=e.dir)&&void 0!==r?r:"",a.nameManually=(null===(t=e.nameManually)||void 0===t?void 0:t.map(e=>e))||[],a.nameAuto=(null===(n=e.nameAuto)||void 0===n?void 0:n.map(e=>e))||[],a}};function c(e){return"object"==typeof e&&null!==e}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:window}},function(e){e.O(0,[714,235,731,575,774,888,179],function(){return e(e.s=84808)}),_N_E=e.O()}]);