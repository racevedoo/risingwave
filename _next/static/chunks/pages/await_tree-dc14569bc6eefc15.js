(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[980],{92299:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/await_tree",function(){return t(25947)}])},14993:function(e,r,t){"use strict";t.d(r,{OL:function(){return o},X8:function(){return c},xv:function(){return i}});var n=t(77617),a=t(79897);async function c(){let e=await a.Z.get("/api/metrics/cluster");return e}async function i(){let e=(await a.Z.get("/api/clusters/1")).map(n.cX.fromJSON);return e}async function o(){let e=(await a.Z.get("/api/clusters/2")).map(n.cX.fromJSON);return e}},6935:function(e,r,t){"use strict";t.d(r,{Z:function(){return c}});var n=t(66479),a=t(67294);function c(e){let[r,t]=(0,a.useState)(),c=(0,n.pm)();return(0,a.useEffect)(()=>{let r=async()=>{try{let r=await e();t(r)}catch(e){c({title:"Error Occurred",description:e.toString(),status:"error",duration:5e3,isClosable:!0}),console.error(e)}};r()},[c,e]),{response:r}}},25947:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return w}});var n=t(85893),a=t(40639),c=t(83234),i=t(57026),o=t(47741),l=t(19604),u=t(96486),s=t.n(u),d=t(9008),m=t.n(d),f=t(67294),p=t(42571),h=t(96756),T=t(12240),v=t(79897),g=t(14993),j=t(6935);function w(){let{response:e}=(0,j.Z)(g.OL),[r,t]=(0,f.useState)(),[u,d]=(0,f.useState)("");(0,f.useEffect)(()=>{e&&!r&&e.length>0&&t(e[0].id)},[e,r]);let w=async()=>{let e;let t="Await-Tree Dump of Compute Node ".concat(r,":");d(void 0);try{let n=T.Kv.fromJSON(await v.Z.get("/api/monitor/await_tree/".concat(r))),a=s()(n.actorTraces).entries().map(e=>{let[r,t]=e;return"[Actor ".concat(r,"]\n").concat(t)}).join("\n"),c=s()(n.rpcTraces).entries().map(e=>{let[r,t]=e;return"[RPC ".concat(r,"]\n").concat(t)}).join("\n");e="".concat(t,"\n\n").concat(a,"\n").concat(c)}catch(r){e="".concat(t,"\n\nError: ").concat(r.message)}d(e)},y=(0,n.jsxs)(a.kC,{p:3,height:"calc(100vh - 20px)",flexDirection:"column",children:[(0,n.jsx)(h.Z,{children:"Await Tree Dump"}),(0,n.jsxs)(a.kC,{flexDirection:"row",height:"full",width:"full",children:[(0,n.jsx)(a.gC,{mr:3,spacing:3,alignItems:"flex-start",width:200,height:"full",children:(0,n.jsxs)(c.NI,{children:[(0,n.jsx)(c.lX,{children:"Compute Nodes"}),(0,n.jsxs)(a.gC,{children:[(0,n.jsx)(i.Ph,{onChange:e=>t(parseInt(e.target.value)),children:e&&e.map(e=>{var r,t;return(0,n.jsxs)("option",{value:e.id,children:["(",e.id,") ",null===(r=e.host)||void 0===r?void 0:r.host,":",null===(t=e.host)||void 0===t?void 0:t.port]},e.id)})}),(0,n.jsx)(o.zx,{onClick:e=>w(),width:"full",children:"Dump"})]})]})}),(0,n.jsx)(a.xu,{flex:1,height:"full",ml:3,overflowX:"scroll",overflowY:"scroll",children:void 0===u?(0,n.jsx)(p.Z,{}):(0,n.jsx)(l.ZP,{language:"sql",options:{fontSize:13,readOnly:!0,renderWhitespace:"boundary",wordWrap:"on"},defaultValue:'Select a compute node and click "Dump"...',value:u})})]})]});return(0,n.jsxs)(f.Fragment,{children:[(0,n.jsx)(m(),{children:(0,n.jsx)("title",{children:"Await Tree Dump"})}),y]})}},12240:function(e,r,t){"use strict";t.d(r,{Kv:function(){return n},R_:function(){return a}});let n={fromJSON:e=>({actorTraces:c(e.actorTraces)?Object.entries(e.actorTraces).reduce((e,r)=>{let[t,n]=r;return e[Number(t)]=String(n),e},{}):{},rpcTraces:c(e.rpcTraces)?Object.entries(e.rpcTraces).reduce((e,r)=>{let[t,n]=r;return e[t]=String(n),e},{}):{},compactionTaskTraces:c(e.compactionTaskTraces)?Object.entries(e.compactionTaskTraces).reduce((e,r)=>{let[t,n]=r;return e[t]=String(n),e},{}):{}}),toJSON(e){let r={};if(e.actorTraces){let t=Object.entries(e.actorTraces);t.length>0&&(r.actorTraces={},t.forEach(e=>{let[t,n]=e;r.actorTraces[t]=n}))}if(e.rpcTraces){let t=Object.entries(e.rpcTraces);t.length>0&&(r.rpcTraces={},t.forEach(e=>{let[t,n]=e;r.rpcTraces[t]=n}))}if(e.compactionTaskTraces){let t=Object.entries(e.compactionTaskTraces);t.length>0&&(r.compactionTaskTraces={},t.forEach(e=>{let[t,n]=e;r.compactionTaskTraces[t]=n}))}return r},create:e=>n.fromPartial(null!=e?e:{}),fromPartial(e){var r,t,n;let a={actorTraces:{},rpcTraces:{},compactionTaskTraces:{}};return a.actorTraces=Object.entries(null!==(r=e.actorTraces)&&void 0!==r?r:{}).reduce((e,r)=>{let[t,n]=r;return void 0!==n&&(e[Number(t)]=String(n)),e},{}),a.rpcTraces=Object.entries(null!==(t=e.rpcTraces)&&void 0!==t?t:{}).reduce((e,r)=>{let[t,n]=r;return void 0!==n&&(e[t]=String(n)),e},{}),a.compactionTaskTraces=Object.entries(null!==(n=e.compactionTaskTraces)&&void 0!==n?n:{}).reduce((e,r)=>{let[t,n]=r;return void 0!==n&&(e[t]=String(n)),e},{}),a}},a={fromJSON:e=>({dir:null!=e.dir?String(e.dir):"",nameManually:Array.isArray(null==e?void 0:e.nameManually)?e.nameManually.map(e=>String(e)):[],nameAuto:Array.isArray(null==e?void 0:e.nameAuto)?e.nameAuto.map(e=>String(e)):[]}),toJSON(e){var r,t;let n={};return""!==e.dir&&(n.dir=e.dir),(null===(r=e.nameManually)||void 0===r?void 0:r.length)&&(n.nameManually=e.nameManually),(null===(t=e.nameAuto)||void 0===t?void 0:t.length)&&(n.nameAuto=e.nameAuto),n},create:e=>a.fromPartial(null!=e?e:{}),fromPartial(e){var r,t,n;let a={dir:"",nameManually:[],nameAuto:[]};return a.dir=null!==(n=e.dir)&&void 0!==n?n:"",a.nameManually=(null===(r=e.nameManually)||void 0===r?void 0:r.map(e=>e))||[],a.nameAuto=(null===(t=e.nameAuto)||void 0===t?void 0:t.map(e=>e))||[],a}};function c(e){return"object"==typeof e&&null!==e}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:window}},function(e){e.O(0,[662,235,575,774,888,179],function(){return e(e.s=92299)}),_N_E=e.O()}]);